<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">


    <title>Giftastic!</title>
</head>

<body>
    <style>
        body {
            background-image: url("images/background.jpg");
            height: 100%;
        }
        h4 {
            color: darkgray;
        }
        p {
            color: white;
        }
        .transparent{
            background-color: rgba(51, 51, 51, 0.767);
        }

    </style>

    <div class="text-white">
        <img class="card-img max-width: 100%" src="images/captain-america-shield-image-cropped.jpg" alt="Header image">
        <div class="card-img-overlay">
            <h1>Choose your hero</h1>
        </div>
    </div>
    <div class="row bg-dark">
        <div class="col-7 mx-auto" id="buttonHolder">
        </div>
        <div class="col-4 mx-auto" id="addButton">
            <form>
                <div class="form-group">
                    <label for="entry">
                        <h4>Add a comic character</h4>
                    </label>
                    <input type="field" class="form-control" id="entry" placeholder="Character's name">
                </div>
                <button type="submit" class="btn btn-dark" id="submit">Submit</button>
            </form>
            <div class="col-1">
            </div>
        </div>
    </div>
    <div class="row col-12 transparent" id="gifSpot">
    </div>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script>

        var buttonArray = ["Batman", "Joker", "The Green Lantern", "Groot", "Superman", "Silver Surfer", "Dr. Strange"];
        function populateButtons() {
            $("#buttonHolder").empty();
            for (var i = 0; i < buttonArray.length; i++) {
                var button = $("<button class='btn btn-dark m-2 gif-button'>");
                button.text(buttonArray[i]);
                button.attr("data-buttonName", buttonArray[i]);
                $("#buttonHolder").append(button);
            }
        }
        populateButtons();

        $(document).on("click", "#submit", function () {
            event.preventDefault();
            var newButton = $("#entry").val().trim();
            buttonArray.push(newButton);
            populateButtons();
        });

        $(document).on("click", '.gif-button', function () {
            var search = $(this).attr("data-buttonName");
            var key = "&api_key=fIkVsSR38IPBG8U8aXmxcLA2TQO0R3ae"
            var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + search + key + "&limit=10";

            $.ajax({
                url: queryURL,
                method: "GET"
            })
                .then(function (response) {

                    var results = response.data;

                    for (var i = 0; i < results.length; i++) {

                        var gifDiv = $("<div>");

                        var p = $("<p>").text("Rating: " + results[i].rating);
                        var gifImage = $("<img class= m-2 id=gifImage>");
                        gifImage.attr("src", results[i].images.fixed_height_small_still.url);
                        gifImage.attr("data-still", results[i].images.fixed_height_small_still.url);
                        gifImage.attr("data-animate", results[i].images.fixed_height_small.url);
                        gifImage.attr("data-state", "still");
                        gifDiv.append(p);
                        gifDiv.append(gifImage);
                        $("#gifSpot").prepend(gifDiv);

                        $("#gifImage").on("click", function () {
                            var state = $(this).attr("data-state");
                            if (state === "still") {
                                $(this).attr("src", $(this).attr("data-animate"));
                                $(this).attr("data-state", "animate");

                            } else {
                                $(this).attr("src", $(this).attr("data-still"));
                                $(this).attr("data-state", "still");


                            }
                        });

                    }
                });

        });
    </script>


</body>

</html>